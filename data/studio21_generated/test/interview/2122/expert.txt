 Heidi has expanded her library and now serves longer request sequences. 
-----Input----- Same as the easy version, but the limits have changed: 1 ≤ n, k ≤ 400 000. -----Output----- Same as the easy version. -----Examples----- Input 4 100 1 2 2 1 Output 2 Input 4 1 1 2 2 1 Output 3 Input 4 2 1 2 3 1 Output 3